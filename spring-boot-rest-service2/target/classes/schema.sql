DROP TABLE IF EXISTS rating;
DROP TABLE IF EXISTS orderline;
DROP TABLE IF EXISTS orders;
DROP TABLE IF EXISTS movie;
DROP TABLE IF EXISTS studio;

CREATE TABLE studio (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  city VARCHAR(255) NOT NULL,
  name VARCHAR(255) NOT NULL,
  state VARCHAR(255) NOT NULL
);

CREATE TABLE movie (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  category VARCHAR(255) NOT NULL,
  description VARCHAR(1000) DEFAULT NULL,
  image VARCHAR(255) DEFAULT NULL,
  name VARCHAR(255) NOT NULL,
  price DOUBLE NOT NULL,
  studio_id BIGINT NOT NULL,
  CONSTRAINT fk_movie_studio FOREIGN KEY (studio_id) REFERENCES studio(id)
);

CREATE TABLE rating (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  stars INT NOT NULL,
  movie_id BIGINT DEFAULT NULL,
  CONSTRAINT fk_rating_movie FOREIGN KEY (movie_id) REFERENCES movie(id)
);

CREATE TABLE orders (
  id INT AUTO_INCREMENT PRIMARY KEY,
  address VARCHAR(255) DEFAULT NULL,
  amount DOUBLE DEFAULT NULL,
  auth_code VARCHAR(255) DEFAULT NULL,
  card_expiry VARCHAR(255) DEFAULT NULL,
  card_number VARCHAR(255) DEFAULT NULL,
  card_security_code VARCHAR(255) DEFAULT NULL,
  customer_name VARCHAR(255) DEFAULT NULL,
  shipped BOOLEAN NOT NULL,
  submitted BOOLEAN NOT NULL
);

CREATE TABLE orderline (
  id INT AUTO_INCREMENT PRIMARY KEY,
  quantity INT DEFAULT NULL,
  movie_id BIGINT DEFAULT NULL,
  order_id INT DEFAULT NULL,
  CONSTRAINT fk_orderline_order FOREIGN KEY (movie_id) REFERENCES movie(id)
);

